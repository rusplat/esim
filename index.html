<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>eSIM Магазин</title>
    <style>
        /* --- CSS Стили --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f2f5;
            color: #333;
        }
        .container {
            max-width: 900px;
            margin: 40px auto;
            padding: 20px;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        h1, h2 {
            color: #0056b3;
            text-align: center;
        }
        .operator-list {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            padding: 20px 0;
        }
        .operator-card {
            background: #e9ecef;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: background 0.3s;
            border: 2px solid transparent;
        }
        .operator-card:hover {
            background: #d9dee4;
            border-color: #007bff;
        }
        .operator-card .price {
            font-size: 1.5em;
            color: #28a745;
            font-weight: bold;
            margin-top: 10px;
        }
        .page {
            display: none; /* Скрываем все страницы по умолчанию */
        }
        .page.active {
            display: block; /* Показываем активную страницу */
        }
        .payment-details {
            border: 2px solid #ffc107;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            background: #fff9e6;
        }
        .crypto-address {
            background: #eee;
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
            font-family: monospace;
            word-break: break-all;
        }
        .qr-code-area {
            text-align: center;
            padding: 20px;
            border: 2px dashed #17a2b8;
            background: #e0f7fa;
            margin-bottom: 20px;
        }
        .btn {
            display: block;
            width: 80%;
            margin: 20px auto;
            padding: 15px;
            border: none;
            border-radius: 5px;
            font-size: 1.1em;
                      cursor: pointer;
            color: white;
            text-align: center;
        }
        /* Стили для скрытия секций */
        .hidden-section {
            display: none;
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        /* Стили для кнопок выбора способа оплаты */
        .payment-options {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            justify-content: center;
        }
        .btn-option {
            background: #6c757d;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }
        .btn-option:hover {
            background: #5a6268;
        }

        /* Стили для списка криптовалют */
        .crypto-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }
        .crypto-address-item {
            padding: 8px 12px;
            background: #007bff;
            color: white;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
        }
        .crypto-address-item:hover {
            background: #0056b3;
        }

        /* Стили для отображения адреса и кнопки копирования */
        .address-display {
            background: #f8f9fa;
            border: 1px dashed #ced4da;
            padding: 15px;
            border-radius: 5px;
            text-align: center;
        }
        .address-text {
            font-family: monospace;
            font-size: 0.9em;
            word-break: break-all;
            margin-bottom: 10px;
        }
        .btn-copy {
            background: #ffc107;
            color: #333;
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
        }
        .btn-copy:hover {
            background: #e0a800;
        }

        /* Стили для большой кнопки "Я ОПЛАТИЛ" */
        .btn-large {
            width: 100%; /* Делаем кнопку широкой */
            margin-top: 20px;
            background: #dc3545; /* Красный цвет для привлечения внимания */
        }
        .btn-large:hover {
            background: #c82333;
        }
        .btn-sbp-final {
            background: #007bff;
        }
        .btn-sbp-final:hover {
            background: #0056b3;
        }
        #btn-pay { background: #007bff; }
        #btn-check { background: #28a745; }
        #btn-pay:hover { background: #0056b3; }
        #btn-check:hover { background: #218838; }
    </style>
</head>
<body>

    <div class="container">
        
        <!-- СТРАНИЦА 1: ВИТРИНА -->
        <div id="page1" class="page active">
            <h1>Выберите eSIM Оператора</h1>
            <div class="operator-list">
                <div class="operator-card" data-operator="МТС" data-price="650 руб.">
                    <p>МТС</p>
                    <div class="price">650 руб.</div>
                </div>
                <div class="operator-card" data-operator="МегаФон" data-price="799 руб.">
                    <p>МегаФон</p>
                    <div class="price">799 руб.</div>
                </div>
                <div class="operator-card" data-operator="Билайн" data-price="549 руб.">
                    <p>Билайн</p>
                    <div class="price">549 руб.</div>
                </div>
                <div class="operator-card" data-operator="Tele2" data-price="920 руб.">
                    <p>Tele2</p>
                    <div class="price">920 руб.</div>
                </div>
                <div class="operator-card" data-operator="Yota" data-price="810 руб.">
                    <p>Yota</p>
                    <div class="price">810 руб.</div>
                </div>
                <div class="operator-card" data-operator="Tinkoff Mobile" data-price="700 руб.">
                    <p>Tinkoff Mobile</p>
                    <div class="price">700 руб.</div>
                </div>
            </div>
        </div>

  <!-- СТРАНИЦА 2: ОПЛАТА (Обновленная) -->
        <div id="page2" class="page">
            <h2>Подтверждение Заказа</h2>
            
            <div class="payment-details">
                <p><strong>Выбрано:</strong> <span id="selected-operator"></span></p>
                <p><strong>Стоимость:</strong> <span id="selected-price"></span></p>
                <p><strong>Описание:</strong> Ваша eSIM будет доступна после подтверждения оплаты. Номер уже **зарегистрирован** на случайный паспорт. Базовый тариф активирован.</p>
                <p><strong>Номер для подключения:</strong> Случайный (Сгенерирован: <span id="random-number"></span>)</p>
            </div>

            <h3>Выберите способ оплаты:</h3>
            
            <!-- КНОПКИ ВЫБОРА СПОСОБА ОПЛАТЫ -->
            <div class="payment-options">
                <button class="btn-option" data-target="crypto">Оплатить криптовалютой</button>
                <button class="btn-option" data-target="sbp">Оплатить через СБП</button>
            </div>
            
            <!-- РАЗДЕЛ КРИПТОВАЛЮТ (Скрыт по умолчанию) -->
            <div id="crypto-section" class="hidden-section">
                <h4>Выберите монету:</h4>
                <div class="crypto-list">
                    <div class="crypto-address-item" data-coin="BTC" data-address="bc1qn6ye3evkl2cj04dhxyk7gvrk72vjhtqhe3gzql">BTC</div>
                    <div class="crypto-address-item" data-coin="USDT TRC20" data-address="TTxL8srvCqom7RebeyZAjuWyActK9R9SD4">USDT TRC20 - 8.42</div>
                    <div class="crypto-address-item" data-coin="ETH" data-address="0x7cf4bc91b11e6179153c5f2531d4ace1446bd973">ETH</div>
                    <div class="crypto-address-item" data-coin="TON" data-address="UQBPy2EbbrKy0vRj42Dau5h6vWYo0NUGSxTo-Ywpuccso8ZP">TON</div>
                    <div class="crypto-address-item" data-coin="LTC" data-address="ltc1qeezhcqd2ctt8v8jwtvyn6v8yuvmzg0tmj46a4s">LTC</div>
                    <div class="crypto-address-item" data-coin="RUBT" data-address="TUzNN7mNRMxQBstZHg8aEaawxxUpjMDc3e">RUBT</div>
                    <div class="crypto-address-item" data-coin="TRX" data-address="TUYgFfet9KQytXjJ9jwQtVANMnTpVigez8">TRX</div>
                </div>
                
                <div id="address-display" class="address-display">
                    <p>Нажмите на монету, чтобы увидеть адрес.</p>
                </div>

                <button class="btn btn-large" id="btn-pay-crypto">Я ОПЛАТИЛ</button>
            </div>
            
            <!-- РАЗДЕЛ СБП (Скрыт по умолчанию) -->
            <div id="sbp-section" class="hidden-section">
                <p>Для оплаты через СБП будет открыто окно банка.</p>
                <a href="https://qr.nspk.ru/AS1A000OS35BAI6I86FRLPOEKFGF6ITL?type=01&bank=100000000008&crc=709D" target="_blank">
                    <button class="btn btn-large btn-sbp-final">ОПЛАТИТЬ ЧЕРЕЗ СБП</button>
                </a>
                <button class="btn btn-large" id="btn-pay-sbp">Я ОПЛАТИЛ</button>
            </div>
            
        </div>
        
        <!-- СТРАНИЦА 3: ОЖИДАНИЕ -->
        <div id="page3" class="page">
            <h2>Проверка Оплаты</h2>
            <div class="qr-code-area">
                <p>Ваш платеж проверяется...</p>
                <div id="qr-display">
                    <!-- Здесь будет сгенерированный QR-код -->
                    <p style="font-size: 1.5em;">Ожидайте, идет генерация...</p>
                </div>
                <p>Пожалуйста, дождитесь, пока система найдет ваш перевод.</p>
            </div>
        </div>

    </div>

       <script>
        // --- JavaScript Логика (Обновленная для многошаговой оплаты) ---
        
        let currentSelection = {};
        
        // 1. ВИРТРИНА (Page 1 -> Page 2)
        document.querySelectorAll('.operator-card').forEach(card => {
            card.addEventListener('click', () => {
                currentSelection.operator = card.dataset.operator;
                currentSelection.price = card.dataset.price;
                
                // Переход на страницу 2
                document.getElementById('page1').classList.remove('active');
                document.getElementById('page2').classList.add('active');
                
                // Заполняем данные на странице 2
                document.getElementById('selected-operator').textContent = currentSelection.operator;
                document.getElementById('selected-price').textContent = currentSelection.price;
                
                // Генерируем 9 случайных цифр
                const random9Digits = Math.floor(Math.random() * 1000000000); // Число от 0 до 999,999,999
                // Форматируем номер: +7 9 + 9 случайных цифр
                document.getElementById('random-number').textContent = `+7 9${random9Digits.toString().padStart(9, '0')}`;    
            });
        });                    
        // 2. ВЫБОР СПОСОБА ОПЛАТЫ (Крипто или СБП)
        document.querySelectorAll('.btn-option').forEach(btn => {
            btn.addEventListener('click', () => {
                const target = btn.dataset.target;
                
                // Скрываем все секции
                document.getElementById('crypto-section').classList.add('hidden-section');
                document.getElementById('sbp-section').classList.add('hidden-section');
                
                // Показываем нужную секцию
                if (target === 'crypto') {
                    document.getElementById('crypto-section').classList.remove('hidden-section');
                } else if (target === 'sbp') {
                    document.getElementById('sbp-section').classList.remove('hidden-section');
                }
            });
        });
        
        // 3. ЛОГИКА ВЫБОРА КРИПТО АДРЕСА И КОПИРОВАНИЕ
        document.getElementById('crypto-section').addEventListener('click', (e) => {
            // Логика для выбора адреса
            if (e.target.classList.contains('crypto-address-item')) {
                const coin = e.target.dataset.coin;
                const address = e.target.dataset.address;
                
                document.getElementById('address-display').innerHTML = `
                    <p><strong>Адрес для оплаты ${coin}:</strong></p>
                    <div class="address-text">${address}</div>
                    <button class="btn-copy" data-address="${address}">Скопировать адрес</button>
                `;
            }
            // Логика для кнопки "Я ОПЛАТИЛ" (Крипто)
            else if (e.target.id === 'btn-pay-crypto') {
                // Проверка, выбран ли адрес перед переходом
                if (document.getElementById('address-display').querySelector('.address-text')) {
                    // Переход на страницу 3
                    document.getElementById('page2').classList.remove('active');
                    document.getElementById('page3').classList.add('active');
                    
                    // Имитация проверки оплаты
                    document.getElementById('qr-display').innerHTML = `
                        <p style="font-size: 1.5em; color: orange;">Идет проверка оплаты...</p>
                        <p>Ожидайте, это займет 30 секунд.</p>
                    `;

                    setTimeout(() => {
                        window.open('https://www.google.com', '_blank'); // ССЫЛКА ПОСЛЕ ОПЛАТЫ
                        
                        document.getElementById('qr-display').innerHTML = `
                            <p style="font-size: 1.5em; color: green;">✅ Генерация QR-кода...</p>
                            <p>QR-код для подключения eSIM будет готов через минуту.</p>
                        `;
                    }, 30000); 

                } else {
                    alert('Пожалуйста, сначала выберите криптовалюту и скопируйте адрес.');
                }
            }
        });
        
        // 4. ЛОГИКА КНОПКИ КОПИРОВАНИЯ (Для крипто)
        document.getElementById('page2').addEventListener('click', (e) => {
            if (e.target.classList.contains('btn-copy')) {
                const addressToCopy = e.target.dataset.address;
                navigator.clipboard.writeText(addressToCopy).then(() => {
                    e.target.textContent = 'Скопировано!';
                    setTimeout(() => { e.target.textContent = 'Скопировать адрес'; }, 1500);
                }).catch(err => {
                    console.error('Ошибка копирования:', err);
                    alert('Ошибка копирования. Пожалуйста, скопируйте вручную.');
                });
            }
        });
        
        // 5. ЛОГИКА КНОПКИ "Я ОПЛАТИЛ" (Для СБП)
        document.getElementById('btn-pay-sbp').addEventListener('click', () => {
            // Переход на страницу 3
            document.getElementById('page2').classList.remove('active');
            document.getElementById('page3').classList.add('active');
            
            // Имитация проверки оплаты
            document.getElementById('qr-display').innerHTML = `
                <p style="font-size: 1.5em; color: orange;">Идет проверка оплаты...</p>
                <p>Ожидайте, это займет 30 секунд.</p>
            `;

            setTimeout(() => {
                // После 30 секунд открываем новую вкладку
                window.open('https://www.google.com', '_blank'); // <--- ССЫЛКА ПОСЛЕ ОПЛАТЫ
                
                document.getElementById('qr-display').innerHTML = `
                    <p style="font-size: 1.5em; color: green;">✅ Генерация QR-кода...</p>
                    <p>QR-код для подключения eSIM будет готов через минуту.</p>
                `;
            }, 30000); 
        });
    </script>
